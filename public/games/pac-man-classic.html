<!DOCTYPE html>
<html lang='en'>
<head>
  <meta charset='UTF-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1.0'>
  <title>Classic Pac-Man - Andy's Fun Zone! üéÆ</title>
  <link rel='stylesheet' href='../css/styles.css'>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive, system-ui;
      background: #000;
      color: #fff;
      margin: 0;
      padding: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .game-header {
      text-align: center;
      padding: 1rem;
      background: #1a1a2e;
      width: 100%;
    }
    
    .game-header h1 {
      color: #ffff00;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
    }
    
    .game-container {
      background: #000;
      border: 3px solid #0000ff;
      padding: 20px;
      margin: 20px;
    }
    
    #gameCanvas {
      background: #000;
      border: 2px solid #0000ff;
      display: block;
    }
    
    .game-info {
      display: flex;
      justify-content: space-between;
      margin: 10px 0;
      color: #ffff00;
      font-weight: bold;
    }
    
    .controls {
      text-align: center;
      margin: 10px 0;
    }
    
    .game-button {
      background: #ffff00;
      color: #000;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 5px;
      font-weight: bold;
      cursor: pointer;
    }
    
    .game-button:hover {
      background: #fff;
    }
  </style>
</head>
<body>
  <a href="../index.html" class="back-button">üè† Back to Home</a>
  
  <div class="game-header">
    <h1>üü° PAC-MAN CLASSIC üü°</h1>
    <p>Use arrow keys or WASD to move. Collect all dots while avoiding ghosts!</p>
  </div>
  
  <div class="game-container">
    <div class="game-info">
      <div>Score: <span id="score">0</span></div>
      <div>Lives: <span id="lives">3</span></div>
      <div>Level: <span id="level">1</span></div>
    </div>
    
    <canvas id="gameCanvas" width="600" height="600"></canvas>
    
    <div class="controls">
      <button class="game-button" onclick="startGame()">üéÆ Start Game</button>
      <button class="game-button" onclick="resetGame()">üîÑ Reset</button>
      <button class="game-button" onclick="pauseGame()">‚è∏Ô∏è Pause</button>
    </div>
  </div>
  
  <script>
    // Game variables
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    
    let gameState = 'menu'; // menu, playing, paused, gameOver
    let score = 0;
    let lives = 3;
    let level = 1;
    let gameRunning = false;
    
    // Grid settings
    const GRID_SIZE = 20;
    const COLS = canvas.width / GRID_SIZE;
    const ROWS = canvas.height / GRID_SIZE;
    
    // Pac-Man
    const pacman = {
      x: 14,
      y: 27,
      direction: 'right',
      nextDirection: 'right',
      mouthOpen: true,
      animationTimer: 0
    };
    
    // Power-up state
    let powerMode = false;
    let powerModeTimer = 0;
    const POWER_MODE_DURATION = 300; // 300 game ticks
    
    // Simple maze layout (1 = wall, 0 = dot, 2 = power pellet, 3 = empty)
    const maze = [
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,2,1,1,1,1,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,0,1,1,1,1,2,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,0,1,1,1,1,1,1],
      [0,0,0,0,0,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0],
      [1,1,1,1,1,1,0,1,1,0,1,1,3,3,3,3,3,3,1,1,0,1,1,0,1,1,1,1,1,1],
      [0,0,0,0,0,0,0,0,0,0,1,3,3,3,3,3,3,3,3,1,0,0,0,0,0,0,0,0,0,0],
      [1,1,1,1,1,1,0,1,1,0,1,3,3,3,3,3,3,3,3,1,0,1,1,0,1,1,1,1,1,1],
      [0,0,0,0,0,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,0,0,0,0,0],
      [1,1,1,1,1,1,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,0,1,1,1,1,0,1],
      [1,2,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,2,1],
      [1,1,1,0,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,0,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,1,0,1,0,1,0,1,0,1,0,1,0,1,0,1,1,1,1,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,1,0,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,0,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,2,1,1,1,1,0,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,0,1,1,1,1,2,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1,1,1,1,1,0,1,1,0,1,1,1,1,1,1],
      [1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1],
      [1,0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,0,0,1,1,1,1,1,1,1,1,1,1,0,1],
      [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]
    ];
    
    // Ghosts
    const ghosts = [
      { x: 14, y: 11, direction: 'up', color: '#ff0000', name: 'Blinky' },
      { x: 13, y: 11, direction: 'up', color: '#ffb8ff', name: 'Pinky' },
      { x: 15, y: 11, direction: 'down', color: '#00ffff', name: 'Inky' },
      { x: 16, y: 11, direction: 'down', color: '#ffb852', name: 'Clyde' }
    ];
    
    // Game functions
    function startGame() {
      gameState = 'playing';
      gameRunning = true;
      gameLoop();
    }
    
    function resetGame() {
      score = 0;
      lives = 3;
      level = 1;
      gameState = 'menu';
      gameRunning = false;
      
      // Reset Pac-Man position
      pacman.x = 14;
      pacman.y = 27;
      pacman.direction = 'right';
      
      // Reset power mode
      powerMode = false;
      powerModeTimer = 0;
      
      // Reset ghosts
      ghosts[0].x = 14; ghosts[0].y = 11;
      ghosts[1].x = 13; ghosts[1].y = 11;
      ghosts[2].x = 15; ghosts[2].y = 11;
      ghosts[3].x = 16; ghosts[3].y = 11;
      
      updateScore();
      draw();
    }
    
    function pauseGame() {
      if (gameState === 'playing') {
        gameState = 'paused';
        gameRunning = false;
      } else if (gameState === 'paused') {
        gameState = 'playing';
        gameRunning = true;
        gameLoop();
      }
    }
    
    function updateScore() {
      document.getElementById('score').textContent = score;
      document.getElementById('lives').textContent = lives;
      document.getElementById('level').textContent = level;
    }
    
    function drawMaze() {
      for (let row = 0; row < maze.length; row++) {
        for (let col = 0; col < maze[row].length; col++) {
          const x = col * GRID_SIZE;
          const y = row * GRID_SIZE;
          
          if (maze[row][col] === 1) {
            // Wall
            ctx.fillStyle = '#0000ff';
            ctx.fillRect(x, y, GRID_SIZE, GRID_SIZE);
          } else if (maze[row][col] === 0) {
            // Dot
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(x + GRID_SIZE/2, y + GRID_SIZE/2, 2, 0, Math.PI * 2);
            ctx.fill();
          } else if (maze[row][col] === 2) {
            // Power pellet
            ctx.fillStyle = '#ffff00';
            ctx.beginPath();
            ctx.arc(x + GRID_SIZE/2, y + GRID_SIZE/2, 6, 0, Math.PI * 2);
            ctx.fill();
          }
        }
      }
    }
    
    function drawPacman() {
      const x = pacman.x * GRID_SIZE + GRID_SIZE/2;
      const y = pacman.y * GRID_SIZE + GRID_SIZE/2;
      
      ctx.fillStyle = '#ffff00';
      ctx.beginPath();
      
      if (pacman.mouthOpen) {
        let startAngle = 0;
        let endAngle = 2 * Math.PI;
        
        if (pacman.direction === 'right') {
          startAngle = 0.2 * Math.PI;
          endAngle = 1.8 * Math.PI;
        } else if (pacman.direction === 'left') {
          startAngle = 1.2 * Math.PI;
          endAngle = 0.8 * Math.PI;
        } else if (pacman.direction === 'up') {
          startAngle = 1.7 * Math.PI;
          endAngle = 1.3 * Math.PI;
        } else if (pacman.direction === 'down') {
          startAngle = 0.7 * Math.PI;
          endAngle = 0.3 * Math.PI;
        }
        
        ctx.arc(x, y, GRID_SIZE/2 - 2, startAngle, endAngle);
        ctx.lineTo(x, y);
      } else {
        ctx.arc(x, y, GRID_SIZE/2 - 2, 0, 2 * Math.PI);
      }
      
      ctx.fill();
    }
    
    function drawGhosts() {
      ghosts.forEach(ghost => {
        const x = ghost.x * GRID_SIZE + GRID_SIZE/2;
        const y = ghost.y * GRID_SIZE + GRID_SIZE/2;
        
        ctx.fillStyle = ghost.color;
        ctx.beginPath();
        ctx.arc(x, y, GRID_SIZE/2 - 2, Math.PI, 0, false);
        ctx.lineTo(x + GRID_SIZE/2 - 2, y + GRID_SIZE/2 - 2);
        ctx.lineTo(x + GRID_SIZE/3, y);
        ctx.lineTo(x, y + GRID_SIZE/2 - 2);
        ctx.lineTo(x - GRID_SIZE/3, y);
        ctx.lineTo(x - GRID_SIZE/2 + 2, y + GRID_SIZE/2 - 2);
        ctx.closePath();
        ctx.fill();
        
        // Eyes
        ctx.fillStyle = '#fff';
        ctx.beginPath();
        ctx.arc(x - 4, y - 4, 2, 0, Math.PI * 2);
        ctx.arc(x + 4, y - 4, 2, 0, Math.PI * 2);
        ctx.fill();
        
        ctx.fillStyle = '#000';
        ctx.beginPath();
        ctx.arc(x - 3, y - 4, 1, 0, Math.PI * 2);
        ctx.arc(x + 5, y - 4, 1, 0, Math.PI * 2);
        ctx.fill();
      });
    }
    
    function draw() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawMaze();
      drawPacman();
      drawGhosts();
      
      if (gameState === 'paused') {
        ctx.fillStyle = 'rgba(0,0,0,0.7)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.fillStyle = '#ffff00';
        ctx.font = '48px Arial';
        ctx.textAlign = 'center';
        ctx.fillText('PAUSED', canvas.width/2, canvas.height/2);
      }
    }
    
    function canMoveTo(x, y) {
      if (x < 0 || x >= COLS || y < 0 || y >= ROWS) return false;
      return maze[y][x] !== 1;
    }
    
    function movePacman() {
      let newX = pacman.x;
      let newY = pacman.y;
      
      // Try to change direction
      if (pacman.nextDirection !== pacman.direction) {
        let testX = pacman.x;
        let testY = pacman.y;
        
        if (pacman.nextDirection === 'up') testY--;
        else if (pacman.nextDirection === 'down') testY++;
        else if (pacman.nextDirection === 'left') testX--;
        else if (pacman.nextDirection === 'right') testX++;
        
        if (canMoveTo(testX, testY)) {
          pacman.direction = pacman.nextDirection;
        }
      }
      
      // Move in current direction
      if (pacman.direction === 'up') newY--;
      else if (pacman.direction === 'down') newY++;
      else if (pacman.direction === 'left') newX--;
      else if (pacman.direction === 'right') newX++;
      
      if (canMoveTo(newX, newY)) {
        pacman.x = newX;
        pacman.y = newY;
        
        // Check for dots
        if (maze[pacman.y][pacman.x] === 0) {
          maze[pacman.y][pacman.x] = 3;
          score += 10;
          updateScore();
        } else if (maze[pacman.y][pacman.x] === 2) {
          maze[pacman.y][pacman.x] = 3;
          score += 50;
          powerMode = true;
          powerModeTimer = POWER_MODE_DURATION;
          // Make ghosts vulnerable
          ghosts.forEach(ghost => {
            ghost.vulnerable = true;
            ghost.originalColor = ghost.color;
            ghost.color = '#0000ff';
          });
          updateScore();
        }
      }
      
      // Animate mouth
      pacman.animationTimer++;
      if (pacman.animationTimer % 10 === 0) {
        pacman.mouthOpen = !pacman.mouthOpen;
      }
    }
    
    function moveGhosts() {
      ghosts.forEach(ghost => {
        // Simple AI - random direction changes
        if (Math.random() < 0.1) {
          const directions = ['up', 'down', 'left', 'right'];
          ghost.direction = directions[Math.floor(Math.random() * directions.length)];
        }
        
        let newX = ghost.x;
        let newY = ghost.y;
        
        if (ghost.direction === 'up') newY--;
        else if (ghost.direction === 'down') newY++;
        else if (ghost.direction === 'left') newX--;
        else if (ghost.direction === 'right') newX++;
        
        if (canMoveTo(newX, newY)) {
          ghost.x = newX;
          ghost.y = newY;
        } else {
          // Change direction if hit wall
          const directions = ['up', 'down', 'left', 'right'];
          ghost.direction = directions[Math.floor(Math.random() * directions.length)];
        }
      });
    }
    
    function updatePowerMode() {
      if (powerMode) {
        powerModeTimer--;
        if (powerModeTimer <= 0) {
          powerMode = false;
          // Reset ghosts to normal
          ghosts.forEach(ghost => {
            ghost.vulnerable = false;
            ghost.color = ghost.originalColor || ghost.color;
          });
        }
      }
    }
    
    function checkCollisions() {
      ghosts.forEach((ghost, index) => {
        if (ghost.x === pacman.x && ghost.y === pacman.y) {
          if (powerMode && ghost.vulnerable) {
            // Eat the ghost
            score += 200;
            updateScore();
            // Reset ghost to center
            ghost.x = 14 + (index % 2);
            ghost.y = 11;
            ghost.vulnerable = false;
            ghost.color = ghost.originalColor;
          } else {
            // Pac-man dies
            lives--;
            updateScore();
            
            if (lives <= 0) {
              gameState = 'gameOver';
              gameRunning = false;
              alert('Game Over! Final Score: ' + score);
            } else {
              // Reset positions
              pacman.x = 14;
              pacman.y = 27;
              powerMode = false;
              powerModeTimer = 0;
              alert('Life lost! Lives remaining: ' + lives);
            }
          }
        }
      });
    }
    
    function gameLoop() {
      if (!gameRunning || gameState !== 'playing') return;
      
      updatePowerMode();
      movePacman();
      moveGhosts();
      checkCollisions();
      draw();
      
      setTimeout(gameLoop, 200);
    }
    
    // Keyboard controls
    document.addEventListener('keydown', function(e) {
      if (gameState !== 'playing') return;
      
      switch (e.key) {
        case 'ArrowUp':
        case 'w':
        case 'W':
          pacman.nextDirection = 'up';
          e.preventDefault();
          break;
        case 'ArrowDown':
        case 's':
        case 'S':
          pacman.nextDirection = 'down';
          e.preventDefault();
          break;
        case 'ArrowLeft':
        case 'a':
        case 'A':
          pacman.nextDirection = 'left';
          e.preventDefault();
          break;
        case 'ArrowRight':
        case 'd':
        case 'D':
          pacman.nextDirection = 'right';
          e.preventDefault();
          break;
      }
    });
    
    // Initialize game
    updateScore();
    draw();
  </script>
</body>
</html>
